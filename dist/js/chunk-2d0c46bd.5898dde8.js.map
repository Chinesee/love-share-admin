{"version":3,"sources":["webpack:///./src/views/goods/GoodsCategory.vue?b0e4","webpack:///src/views/goods/GoodsCategory.vue","webpack:///./src/views/goods/GoodsCategory.vue?608c","webpack:///./src/views/goods/GoodsCategory.vue"],"names":["render","_vm","this","_h","$createElement","_c","_self","staticClass","attrs","data","categoryList","titles","props","key","label","on","left-check-change","leftCheckChange","change","activeChange","model","value","callback","$$v","onActive","expression","slot","color","size","disabled","click","$event","deleteCategory","_v","width","trigger","showPopover","label-placeholder","keyup","type","indexOf","_k","keyCode","addCategory","categoryName","active","showAlert","icon","staticRenderFns","GoodsCategoryvue_type_script_lang_js_","name","leftCheck","computed","$store","state","_this","some","el","length","watch","handler","v","filter","activation","map","_id","immediate","methods","_addCategory2","Object","asyncToGenerator","regeneratorRuntime","mark","_callee","_ref","code","wrap","_context","prev","next","category","category_name","sent","dispatch","stop","apply","arguments","_deleteCategory2","_callee2","_context2","category_id_list","finish","checked","_activeChange","_callee3","origin","direction","_context3","_x","_x2","_x3","goods_GoodsCategoryvue_type_script_lang_js_","component","componentNormalizer","__webpack_exports__"],"mappings":"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","file":"js/chunk-2d0c46bd.5898dde8.js","sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"pt-8\"},[_c('el-transfer',{attrs:{\"data\":_vm.categoryList,\"titles\":['可用分类', '已上架分类'],\"props\":{key: '_id', label: 'name'}},on:{\"left-check-change\":_vm.leftCheckChange,\"change\":_vm.activeChange},model:{value:(_vm.onActive),callback:function ($$v) {_vm.onActive=$$v},expression:\"onActive\"}},[_c('div',{staticClass:\"h-full flex-row-center\",attrs:{\"slot\":\"left-footer\"},slot:\"left-footer\"},[_c('vs-button',{staticClass:\"mr-2\",attrs:{\"slot\":\"reference\",\"color\":\"danger\",\"size\":\"small\",\"disabled\":_vm.disabled},on:{\"click\":function($event){return _vm.deleteCategory()}},slot:\"reference\"},[_vm._v(\"删除选中分类\")]),_c('el-popover',{attrs:{\"width\":\"250\",\"trigger\":\"manual\"},model:{value:(_vm.showPopover),callback:function ($$v) {_vm.showPopover=$$v},expression:\"showPopover\"}},[_c('div',[_c('vs-input',{staticClass:\"w-full mb-2\",attrs:{\"label-placeholder\":\"分类名称\"},on:{\"keyup\":function($event){if(!$event.type.indexOf('key')&&_vm._k($event.keyCode,\"enter\",13,$event.key,\"Enter\")){ return null; }return _vm.addCategory()}},model:{value:(_vm.categoryName),callback:function ($$v) {_vm.categoryName=$$v},expression:\"categoryName\"}}),_c('vs-alert',{attrs:{\"color\":\"danger\",\"active\":_vm.showAlert}},[_vm._v(\"已存在分类，请勿重复添加\")]),_c('div',{staticClass:\"flex justify-end\"},[_c('vs-button',{staticClass:\"danger text-lg\",attrs:{\"type\":\"flat\",\"color\":\"danger\",\"icon\":\"close\"},on:{\"click\":function($event){_vm.showPopover = false}}}),_c('vs-button',{staticClass:\"text-lg\",attrs:{\"type\":\"flat\",\"icon\":\"done\"},on:{\"click\":function($event){return _vm.addCategory()}}})],1)],1),_c('vs-button',{attrs:{\"slot\":\"reference\",\"size\":\"small\"},on:{\"click\":function($event){_vm.showPopover = !_vm.showPopover}},slot:\"reference\"},[_vm._v(\"添加分类\")])],1)],1)])],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <div class=\"pt-8\">\n    <el-transfer\n      v-model=\"onActive\"\n      :data=\"categoryList\"\n      :titles=\"['可用分类', '已上架分类']\"\n      :props=\"{key: '_id', label: 'name'}\"\n      @left-check-change=\"leftCheckChange\"\n      @change=\"activeChange\"\n    >\n      <div\n        slot=\"left-footer\"\n        class=\"h-full flex-row-center\"\n      >\n        <vs-button\n          slot=\"reference\"\n          class=\"mr-2\"\n          color=\"danger\"\n          size=\"small\"\n          :disabled=\"disabled\"\n          @click=\"deleteCategory()\"\n        >删除选中分类</vs-button>\n        <el-popover\n          width=\"250\"\n          trigger=\"manual\"\n          v-model=\"showPopover\"\n        >\n          <div>\n            <vs-input\n              class=\"w-full mb-2\"\n              label-placeholder=\"分类名称\"\n              v-model=\"categoryName\"\n              @keyup.enter=\"addCategory()\"\n            />\n            <vs-alert\n              color=\"danger\"\n              :active=\"showAlert\"\n            >已存在分类，请勿重复添加</vs-alert>\n            <div class=\"flex justify-end\">\n              <vs-button\n                class=\"danger text-lg\"\n                type=\"flat\"\n                color=\"danger\"\n                icon=\"close\"\n                @click=\"showPopover = false\"\n              ></vs-button>\n              <vs-button\n                class=\"text-lg\"\n                type=\"flat\"\n                icon=\"done\"\n                @click=\"addCategory()\"\n              ></vs-button>\n            </div>\n          </div>\n          <vs-button\n            size=\"small\"\n            slot=\"reference\"\n            @click=\"showPopover = !showPopover\"\n          >添加分类</vs-button>\n        </el-popover>\n      </div>\n    </el-transfer>\n  </div>\n</template>\n\n<script>\nimport { addCategory, deleteCategory, updateCategoryActivation } from '@/request/api/category'\n\nexport default {\n  name: 'GoodsCategory',\n  data: () => ({\n    showPopover: false,\n    categoryName: '',\n    onActive: [],\n    leftCheck: [],\n  }),\n\n  computed: {\n    categoryList() {\n      return this.$store.state.categoryList\n    },\n    showAlert() {\n      return this.categoryList.some(el => el.name === this.categoryName)\n    },\n    disabled() {\n      return this.leftCheck.length <= 0\n    },\n  },\n\n  watch: {\n    categoryList: {\n      handler(v) {\n        this.onActive = v.filter(el => el.activation).map(el => el._id)\n      },\n      immediate: true,\n    },\n  },\n\n  methods: {\n    // 添加分类\n    async addCategory() {\n      if (this.categoryName.length > 0) {\n        const { code } = await addCategory({ category_name: this.categoryName })\n        if (code === 2000) {\n          this.categoryName = ''\n          this.showPopover = false\n          this.$store.dispatch('getCategoryList')\n        }\n      }\n    },\n\n    // 删除分类\n    async deleteCategory() {\n      try {\n        await deleteCategory({ category_id_list: this.leftCheck })\n        this.$store.dispatch('getCategoryList')\n      } finally {\n        this.leftCheck = []\n      }\n    },\n\n    leftCheckChange(checked) {\n      this.leftCheck = checked\n    },\n\n    // 已上架的分类发生改变时\n    async activeChange(origin, direction, value) {\n      try {\n        if (direction === 'right') {\n          await updateCategoryActivation({ category_id_list: value, activation: true })\n        } else if (direction === 'left') {\n          await updateCategoryActivation({ category_id_list: value, activation: false })\n        }\n      } finally {\n        this.$store.dispatch('getCategoryList')\n      }\n    },\n  },\n}\n</script>\n\n<style lang=\"scss\" scoped>\n</style>\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./GoodsCategory.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./GoodsCategory.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./GoodsCategory.vue?vue&type=template&id=4f96bb80&scoped=true&\"\nimport script from \"./GoodsCategory.vue?vue&type=script&lang=js&\"\nexport * from \"./GoodsCategory.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"4f96bb80\",\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}