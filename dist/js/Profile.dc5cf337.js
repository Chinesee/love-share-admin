(window.webpackJsonp=window.webpackJsonp||[]).push([["Profile"],{"02e5":function(t,e,s){t.exports=s.p+"img/bind_user.9b9a48f4.svg"},"2c74":function(t,e,s){"use strict";var i=s("6a13");s.n(i).a},"3b42":function(t,e,s){"use strict";s.r(e);var i={name:"ProfileWelcome",computed:{remainingTask(){return this.$store.getters["todo/remainingTask"]}}},a=(s("9e0d"),s("2877")),r=Object(a.a)(i,function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"relative p-5 radius base-shadow overflow-hidden",staticStyle:{height:"150px"}},[s("div",{staticClass:"relative z-50 flex flex-col"},[s("div",{staticClass:"mb-1 text-primary text-2xl font-bold"},[t._v("欢迎回来")]),s("div",{staticClass:"text-xl text-gray"},[t._v("您今天有 "+t._s(t.remainingTask.length)+" 个任务")]),s("div",[s("feather",{staticClass:"mt-5 text-gray cursor-pointer",attrs:{size:"20",type:"list"},on:{click:function(e){return t.$router.push("/todo-list")}}})],1)]),s("div",{staticClass:"img absolute top-0 transition",staticStyle:{right:"-1px"}},[s("el-image",{staticClass:"w-64",attrs:{fit:"contain",src:"https://gitee.com/chinesee/images/raw/master/img/img_020.png"}})],1)])},[],!1,null,"2bdb3ff2",null).exports,n=s("9d63"),o=s.n(n),l={name:"ProfileTodo",components:{VuePerfectScrollbar:o.a},computed:{filterItems(){return this.$store.getters["todo/filterItems"]({})}}},c=(s("2c74"),Object(a.a)(l,function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("div",{staticClass:"mb-6 flex justify-between items-center"},[s("div",{staticClass:"text-primary text-lg font-bold"},[t._v("任务列表")]),s("div",{staticClass:"w-10 h-10 flex-row-center\n       primary-semi bg-primary-10 radius cursor-pointer",on:{click:function(e){return t.$store.commit("todo/SET_TODO_POPUP_STATUS",{status:!0})}}},[s("feather",{attrs:{size:"20",type:"plus"}})],1)]),s("VuePerfectScrollbar",{staticClass:"overflow-hidden",class:{"pb-6":t.filterItems.length>5},staticStyle:{"max-height":"300px"},attrs:{settings:{maxScrollbarLength:200,wheelSpeed:.6}}},[s("ul",[t._l(t.filterItems,function(e,i){return s("li",{key:i,staticClass:"mb-4 flex"},[s("div",{staticClass:"mr-2"},[s("i",{staticClass:"text-lg",class:e.is_done?"el-icon-check text-semi":"el-icon-news primary"})]),s("div",{staticStyle:{width:"90%"}},[s("div",{staticClass:"text-semi font-bold"},[t._v(t._s(e.title))]),s("p",{staticClass:"content-overflow text-sm text-gray"},[t._v(t._s(e.content))])])])}),0===t.filterItems.length?s("li",{staticClass:"p-5 flex-row-center bg-gray radius text-semi"},[s("p",{staticClass:"text-center"},[t._v("\n          ✧*｡٩(ˊωˋ*)و✧*｡ "),s("br"),s("span",{staticClass:"text-sm"},[t._v("没有任务")])])]):t._e()],2)])],1)},[],!1,null,"dc697cc6",null).exports),d=s("1da1"),u=s("518e"),m={name:"ProfileLog",components:{VuePerfectScrollbar:o.a},data:()=>({log:{}}),created(){this.getSignLog()},methods:{getSignLog(){var t=this;return Object(d.a)(function*(){const e=yield Object(u.g)(),s=e.code,i=e.data;2e3===s&&(t.log=i.log)})()}}},f=Object(a.a)(m,function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"relative overflow-hidden"},[s("h2",{staticClass:"mb-2 text-primary text-lg font-bold"},[t._v("登录日志")]),s("VuePerfectScrollbar",{staticClass:"pb-6 overflow-hidden",staticStyle:{"max-height":"350px"},attrs:{settings:{maxScrollbarLength:200,wheelSpeed:.6}}},[s("ul",t._l(t.log,function(e,i){return s("li",{key:i,staticClass:"mb-4 p-3 text-gray text-sm bg-gray radius"},[1===e.position.code?s("div",[s("i",{staticClass:"el-icon-map-location mr-1"}),s("span",[t._v(t._s(e.position.regeocode.formatted_address))])]):s("div",[s("i",{staticClass:"el-icon-warning-outline mr-1"}),s("span",[t._v("未记录位置")])]),s("div",{staticClass:"my-2",attrs:{title:"登录设备"}},[s("i",{staticClass:"el-icon-monitor mr-1"}),s("span",{staticClass:"text-xs"},[t._v(t._s(e.device))])]),s("div",{attrs:{title:"登录时间"}},[s("i",{staticClass:"el-icon-time mr-1"}),s("span",{staticClass:"text-xs"},[t._v(t._s(t.$dayjs(e.created_at).format("YYYY/MM/DD HH:mm:ss")))])])])}),0)]),s("div",{staticClass:"shadow-hidden absolute bottom-0 py-3 bg-main bg-gray-200",staticStyle:{width:"110%",left:"50%",transform:"translateX(-50%)"}})],1)},[],!1,null,null,null).exports,h={name:"ProfileLog",data:()=>({account:"",showInput:!1,info:null}),computed:{userId(){return this.$store.getters["admin/userId"]}},created(){this.userId&&this.getUserInfo()},methods:{onBindUser(){this.showInput?this.account.length>0&&this.bindUser():this.showInput=!0},bindUser(){var t=this;return Object(d.a)(function*(){2e3===(yield Object(u.a)({account:t.account})).code&&(yield t.$store.dispatch("admin/getAdminInfo"),t.$store.dispatch("chat/initChat"),t.getUserInfo())})()},unbindUser(){var t=this;return Object(d.a)(function*(){if(t.userId){2e3===(yield Object(u.k)()).code&&(t.info=null,yield t.$store.dispatch("admin/getAdminInfo"),t.$store.dispatch("chat/initChat"))}})()},getUserInfo(){var t=this;return Object(d.a)(function*(){const e=yield Object(u.h)({user_id:t.userId}),s=e.code,i=e.data;2e3===s&&(t.info=i.user_info)})()}}},p=(s("9861"),{name:"Profile",components:{ProfileWelcome:r,ProfileTodo:c,ProfileLog:f,ProfileBind:Object(a.a)(h,function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"bg-gray flex radius overflow-hidden",class:{"p-5 items-center":t.info,"px-5 pt-5 justify-between":!t.info}},[t.info?[i("div",[i("el-image",{staticClass:"w-24 mr-4 radius base-shadow",attrs:{src:t.info.avatar_url+"?imageView2/2/w/150"}})],1),i("div",[i("div",{staticClass:"text-lg text-primary font-bold"},[t._v("\n        "+t._s(t.info.nickname)+"\n      ")]),i("div",{staticClass:"my-1 text-xs text-gray"},[t._v("\n        "+t._s(t.info.school.name)+"\n      ")]),i("div",{staticClass:"danger text-sm cursor-pointer",on:{click:function(e){return t.unbindUser()}}},[t._v("解除绑定")])]),i("div",{staticClass:"ml-auto"},[i("vs-button",{attrs:{icon:"el-icon-right","icon-pack":"el-icon"},on:{click:function(e){return t.$router.push({path:"/user-detail",query:{userId:t.userId}})}}})],1)]:[i("div",{staticClass:"flex-1 mr-6 pb-4 flex-col-center"},[i("div",{staticClass:"text-primary text-lg"},[t._v("您好，请绑定用户")]),i("div",{staticClass:"input-wrapper mt-2 flex overflow-hidden",class:{"show-input":t.showInput,"hide-input":!t.showInput}},[i("vs-input",{attrs:{placeholder:"请输入用户账号..."},on:{keyup:[function(e){if(!e.type.indexOf("key")&&t._k(e.keyCode,"esc",27,e.key,["Esc","Escape"]))return null;t.showInput=!t.showInput},function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.bindUser()}]},model:{value:t.account,callback:function(e){t.account=e},expression:"account"}}),i("div",{staticClass:"btn h-full flex-row-center cursor-pointer",attrs:{title:"绑定用户 (=・ω・=)"},on:{click:function(e){return t.onBindUser()}}},[t.showInput?i("feather",{staticClass:"text-white",attrs:{size:"22",type:"link-2"}}):i("div",{staticClass:"text-white text-sm"},[t._v("绑定用户")])],1)],1)]),i("img",{staticClass:"svg_img w-48",attrs:{src:s("02e5")}})]],2)},[],!1,null,"1dcfdf82",null).exports,EditPermission:s("4411").a},data:()=>({}),computed:{permissions(){return this.$store.state.admin.info.permissions}},created(){this.$store.commit("SET_NAV_TYPE","hidden"),this.$store.commit("SWITCH_SIDEBAR_COLLAPSE",!0)},destroyed(){this.$store.commit("SET_NAV_TYPE","fixed"),this.$store.commit("SWITCH_SIDEBAR_COLLAPSE",!1)}}),v=Object(a.a)(p,function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"py-6"},[e("div",{staticClass:"flex"},[e("div",{staticClass:"w-1/2 pr-3"},[e("ProfileWelcome",{staticClass:"mb-5"}),e("ProfileTodo")],1),e("div",{staticClass:"w-1/2 pl-3"},[e("ProfileBind",{staticClass:"mb-5"}),e("ProfileLog")],1)]),e("div",[e("h2",{staticClass:"mt-4 mb-2 text-primary text-lg font-bold"},[this._v("管理权限")]),e("EditPermission",{attrs:{permissions:this.permissions}})],1)])},[],!1,null,null,null);e.default=v.exports},4411:function(t,e,s){"use strict";s("ac6a");var i={name:"EditPermission",props:{editable:{type:Boolean,default:!1},allSelected:Boolean,permissions:Array},data:()=>({per:[],modules:{user:"用户",goods:"商品",order:"订单",comment:"留言",guide:"指引",admin:"管理员"},actions:["read","write","create","delete"]}),watch:{permissions:{handler(t){t?this.setPermissions():this.initValues()},immediate:!0},allSelected(t){this.setAllCheckboxStatus(t)}},methods:{initValues(){const t=[{read:!1},{write:!1},{create:!1},{delete:!1}];this.per=Object.keys(this.modules).map(e=>({module:e,purview:this.$cloneDeepWith(t)}))},setPermissions(){const t=this.$cloneDeepWith(this.permissions);this.per=Object.keys(this.modules).map(e=>{for(const s of t)if(s.module===e)return{module:e,purview:this.actions.map(t=>{const e={};return e[`${t}`]=s.purview.includes(t),e})};return{module:e,purview:[{read:!1},{write:!1},{create:!1},{delete:!1}]}})},setAllCheckboxStatus(t){this.per.forEach(e=>{e.purview.forEach((e,s)=>{e[this.actions[s]]=t})})},getPermissions(){return this.per.map(t=>({module:t.module,purview:t.purview.filter((t,e)=>t[this.actions[e]]).map(t=>Object.keys(t)[0])}))}}},a=(s("9e95"),s("2877")),r=Object(a.a)(i,function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[t.per?s("table",{staticClass:"permission"},[t._m(0),t._l(t.per,function(e,i){return s("tr",{key:i},[s("td",[t._v(t._s(t.modules[e.module]))]),t._l(e.purview,function(e,i){return s("td",{key:i},[s("vs-checkbox",{class:{"pointer-events-none":!t.editable},attrs:{disabled:!t.editable},model:{value:e[t.actions[i]],callback:function(s){t.$set(e,t.actions[i],s)},expression:"td[actions[j]]"}})],1)})],2)})],2):t._e()])},[function(){var t=this.$createElement,e=this._self._c||t;return e("tr",[e("th",[this._v("Module")]),e("th",[this._v("Read")]),e("th",[this._v("Write")]),e("th",[this._v("Create")]),e("th",[this._v("Delete")])])}],!1,null,"19adfc7a",null);e.a=r.exports},5945:function(t,e,s){},"679b":function(t,e,s){},"6a13":function(t,e,s){},"86df":function(t,e,s){},9861:function(t,e,s){"use strict";var i=s("679b");s.n(i).a},"9e0d":function(t,e,s){"use strict";var i=s("5945");s.n(i).a},"9e95":function(t,e,s){"use strict";var i=s("86df");s.n(i).a}}]);