(window.webpackJsonp=window.webpackJsonp||[]).push([["ProfileSetting"],{"202e":function(e,t,a){},"3bda":function(e,t,a){"use strict";const r=(e,t,a)=>{t?/^[\d\w\u4e00-\u9fa5,.;:"'?!-]{2,12}$/.test(t)||a(new Error("昵称的格式不正确")):a(new Error("请填写昵称")),a()},s=(e,t,a)=>{t?/^[\u4e00-\u9fa5]{1,6}(·[\u4e00-\u9fa5]{1,6}){0,2}$/.test(t)||a(new Error("姓名的格式不正确")):a(new Error("请填写姓名")),a()},o=(e,t,a)=>{t?/^[\w.-]+@(?:[a-z0-9]+(?:-[a-z0-9]+)*\.)+[a-z]{2,3}$/.test(t)||a(new Error("邮箱的格式不正确")):a(),a()};var n={name:"EditForm",props:{formData:Object},data:()=>({form:{},rules:{nickname:[{validator:r,trigger:"blur"}],real_name:[{validator:s,trigger:"blur"}],email:[{validator:o,trigger:"blur"}]}}),watch:{formData:{handler(e){this.form=e||{account:"",nickname:"",real_name:"",email:""}},immediate:!0}},methods:{submit(){let e;return this.$refs.form.validate(t=>t?(e=!0,!0):(e=!1,!1)),e}}},i=(a("83ca"),a("2877")),l=Object(i.a)(n,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-form",{ref:"form",staticClass:"edit",attrs:{"hide-required-asterisk":"",rules:e.rules,model:e.form}},[a("el-form-item",{attrs:{label:"登入账号",prop:"account",required:""}},[a("el-input",{attrs:{placeholder:"请填写登入账号"},model:{value:e.form.account,callback:function(t){e.$set(e.form,"account",t)},expression:"form.account"}})],1),a("el-form-item",{attrs:{label:"昵称",prop:"nickname"}},[a("el-input",{attrs:{placeholder:"只能是中文、字母、数字"},model:{value:e.form.nickname,callback:function(t){e.$set(e.form,"nickname",t)},expression:"form.nickname"}})],1),a("el-form-item",{attrs:{label:"真实姓名",prop:"real_name"}},[a("el-input",{model:{value:e.form.real_name,callback:function(t){e.$set(e.form,"real_name",t)},expression:"form.real_name"}})],1),a("el-form-item",{attrs:{label:"邮箱（选填）",prop:"email"}},[a("el-input",{model:{value:e.form.email,callback:function(t){e.$set(e.form,"email",t)},expression:"form.email"}})],1)],1)],1)},[],!1,null,"17dcd5f5",null);t.a=l.exports},"452e":function(e,t,a){"use strict";a.r(t);a("a481");var r=a("1da1"),s=a("b0e1"),o=a("3bda"),n=a("bb2a"),i=a("518e"),l={name:"ProfileSetting",components:{EditAvatar:s.a,EditForm:o.a,EditPassword:n.a},data:()=>({active:0,info:{},detail:{},password:"",lockPwd:""}),created(){this.getAdminDetail()},mounted(){},methods:{getAdminDetail(){var e=this;return Object(r.a)(function*(){const t=yield Object(i.d)({admin_id:e.$store.getters["admin/adminId"]}),a=t.code,r=t.data.admin_detail;2e3===a&&(e.detail=r,e.info={_id:r._id,nickname:r.nickname,real_name:r.real_name,email:r.email})})()},updatePassword(){var e=this;return Object(r.a)(function*(){if(e.$refs.editPassword.submit()){const t=e.$refs.editPassword.form,a=t.oldPassword,r=t.password2;2e3===(yield Object(i.n)({old_pwd:a,new_pwd:r})).code&&(yield e.$store.dispatch("admin/SignOut"),e.$router.replace("/sign"))}})()},onUpdateAmin(){var e=this;return Object(r.a)(function*(){if(e.$refs.editForm.submit()){const t=Object.assign({admin_id:e.info._id,gender:e.$refs.editAvatar.selectedGender},e.$refs.editForm.form);try{const a=yield Object(i.l)(t),r=a.code,s=a.msg;if(2e3!==r)throw new Error(s);yield e.getAdminDetail(),e.$vs.notify({title:"信息更新成功",text:s,color:"success"})}catch(t){e.$vs.notify({title:"信息更新失败",text:t,color:"danger"})}}})()},updateLockPassword(){var e=this;return Object(r.a)(function*(){if(e.password.length>0&&e.lockPwd.length>0){const t=yield Object(i.m)({password:e.password,lock_password:e.lockPwd}),a=t.code,r=t.msg;2e3===a&&(yield e.$store.dispatch("admin/getAdminInfo"),e.$vs.notify({title:"更新成功",text:r,color:"success"}))}})()}}},d=(a("990d"),a("2877")),c=Object(d.a)(l,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("vs-tabs",{attrs:{position:"left"},model:{value:e.active,callback:function(t){e.active=t},expression:"active"}},[a("vs-tab",{attrs:{label:"信息编辑",icon:"el-icon-user","icon-pack":"el-icon"}},[a("div",{staticClass:"pt-2 px-8 flex"},[a("div",{staticClass:"mr-16"},[a("EditAvatar",{ref:"editAvatar",attrs:{"admin-id":e.detail._id,avatar:e.detail.avatar_url,gender:e.detail.gender},on:{updateInfo:function(t){return e.getAdminDetail()}}})],1),a("div",{staticClass:"w-1/3 mb-4"},[a("EditForm",{ref:"editForm",attrs:{"form-data":e.info}}),a("vs-button",{attrs:{id:"btn"},on:{click:function(t){return e.onUpdateAmin()}}},[e._v("确认修改")])],1)])]),a("vs-tab",{attrs:{label:"修改密码",icon:"el-icon-lock","icon-pack":"el-icon"}},[a("div",{staticClass:"px-8 mb-4 w-1/2"},[a("EditPassword",{ref:"editPassword"}),a("vs-button",{attrs:{id:"btn"},on:{click:function(t){return e.updatePassword()}}},[e._v("确认修改密码")])],1)]),a("vs-tab",{attrs:{label:"锁屏密码",icon:"el-icon-monitor","icon-pack":"el-icon"}},[a("div",{staticClass:"w-2/3 ml-10 mb-4"},[a("vs-input",{staticClass:"mb-4",attrs:{type:"password",label:"登录密码",placeholder:"请填写您的登录密码"},on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.updateLockPassword()}},model:{value:e.password,callback:function(t){e.password="string"==typeof t?t.trim():t},expression:"password"}}),a("vs-input",{staticClass:"mb-4",attrs:{type:"password",label:"新的锁屏密码",placeholder:"按回车键提交"},on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.updateLockPassword()}},model:{value:e.lockPwd,callback:function(t){e.lockPwd="string"==typeof t?t.trim():t},expression:"lockPwd"}}),a("vs-button",{attrs:{id:"btn"},on:{click:function(t){return e.updateLockPassword()}}},[e._v("修改锁屏密码")])],1)])],1)],1)},[],!1,null,"4db5a216",null);t.default=c.exports},"83ca":function(e,t,a){"use strict";var r=a("dd8e");a.n(r).a},"990d":function(e,t,a){"use strict";var r=a("ed49");a.n(r).a},b0e1:function(e,t,a){"use strict";var r=a("8bbf");const s=a.n(r).a.component("ReplaceAvatar",()=>Promise.all([a.e("chunk-15f04740"),a.e("chunk-f438a7e6")]).then(a.bind(null,"0a78"))),o={male:"https://cdn.hrspider.top/default_avatar_male.jpg",female:"https://cdn.hrspider.top/default_avatar_female.jpg"};var n={name:"EditAvatar",components:{ReplaceAvatar:s},props:{adminId:String,avatar:String,gender:Number},data:()=>({defaultAvatar:o,selectedGender:0,avatarUrl:"https://cdn.hrspider.top/default_avatar_male.jpg",showAvatarPopup:!1}),watch:{selectedGender:{handler(e){const t=this.defaultAvatar,a=t.male,r=t.female;this.avatarUrl!==a&&this.avatarUrl!==r||(this.avatarUrl=e?r:a)},immediate:!0},avatar:{handler(e){(null==e?void 0:e.length)>0&&(this.avatarUrl=e)},immediate:!0},gender:{handler(e){e&&(this.selectedGender=e)},immediate:!0}}},i=a("2877"),l=Object(i.a)(n,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("img",{staticClass:"heavy-shadow radius",attrs:{width:"150px",src:e.avatarUrl}}),a("div",{staticClass:"my-3  flex"},[a("div",{staticClass:"mr-3 px-3 py-1 primary rounded-lg cursor-pointer",staticStyle:{background:"rgba(var(--vs-primary), 0.1)"},on:{click:function(t){e.selectedGender=0}}},[e._v("\n      汉子\n      "),a("i",{directives:[{name:"show",rawName:"v-show",value:!e.selectedGender,expression:"!selectedGender"}],staticClass:"el-icon-check"})]),a("div",{staticClass:"px-3 py-1 danger rounded-lg cursor-pointer",staticStyle:{background:"rgba(var(--vs-danger), 0.1)"},on:{click:function(t){e.selectedGender=1}}},[e._v("\n      妹纸\n      "),a("i",{directives:[{name:"show",rawName:"v-show",value:e.selectedGender,expression:"selectedGender"}],staticClass:"el-icon-check"})])]),e.adminId?a("vs-button",{staticClass:"w-full max-w-xs",attrs:{size:"small",type:"border"},on:{click:function(t){e.showAvatarPopup=!0}}},[e._v("更换头像")]):e._e(),a("ReplaceAvatar",{ref:"replaceAvatar",attrs:{"admin-id":e.adminId,popupActive:e.showAvatarPopup},on:{updateInfo:function(t){return e.$emit("updateInfo")},closePopup:function(t){e.showAvatarPopup=!1}}})],1)},[],!1,null,null,null);t.a=l.exports},bb2a:function(e,t,a){"use strict";const r=(e,t,a)=>{t||a(new Error("请填写原始密码")),a()},s=(e,t,a)=>{t?/^[\w]{6,16}$/.test(t)||a(new Error("密码不符合规范")):a(new Error("请填写密码")),a()};var o={name:"EditPassword",data(){return{form:{oldPassword:"",password:"",password2:""},rules:{oldPassword:[{validator:r,trigger:"blur"}],password:[{validator:s,trigger:"blur"}],password2:[{validator:(e,t,a)=>{t?t!==this.form.password&&a(new Error("与前一次密码不一致")):a(new Error("请确认二次密码")),a()},trigger:"blur"}]}}},methods:{submit(){let e;return this.$refs.form.validate(t=>t?(e=!0,!0):(e=!1,!1)),e}}},n=(a("ea7f"),a("2877")),i=Object(n.a)(o,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-form",{ref:"form",staticClass:"edit",attrs:{"label-position":"top",rules:e.rules,model:e.form}},[a("el-form-item",{attrs:{label:"原始密码",prop:"oldPassword"}},[a("el-input",{attrs:{type:"password",placeholder:"请填写账号原始密码"},model:{value:e.form.oldPassword,callback:function(t){e.$set(e.form,"oldPassword",t)},expression:"form.oldPassword"}})],1),a("el-form-item",{attrs:{label:"密码",prop:"password"}},[a("el-input",{attrs:{type:"password",placeholder:"6-16个字符，只能是字母、数字和下划线"},model:{value:e.form.password,callback:function(t){e.$set(e.form,"password",t)},expression:"form.password"}})],1),a("el-form-item",{attrs:{label:"确认密码",prop:"password2"}},[a("el-input",{attrs:{type:"password",placeholder:"请再次输入密码"},model:{value:e.form.password2,callback:function(t){e.$set(e.form,"password2",t)},expression:"form.password2"}})],1)],1)],1)},[],!1,null,"9c93887c",null);t.a=i.exports},dd8e:function(e,t,a){},ea7f:function(e,t,a){"use strict";var r=a("202e");a.n(r).a},ed49:function(e,t,a){}}]);