(window.webpackJsonp=window.webpackJsonp||[]).push([["AdminEdit"],{1169:function(t,e,r){var n=r("2d95");t.exports=Array.isArray||function(t){return"Array"==n(t)}},"2d82":function(t,e,r){},"2e72":function(t,e,r){},"37c8":function(t,e,r){e.f=r("2b4c")},"39f7":function(t,e,r){},"3a72":function(t,e,r){var n=r("7726"),a=r("8378"),i=r("2d00"),o=r("37c8"),s=r("86cc").f;t.exports=function(t){var e=a.Symbol||(a.Symbol=i?{}:n.Symbol||{});"_"==t.charAt(0)||t in e||s(e,t,{value:o.f(t)})}},"3bda":function(t,e,r){"use strict";var n=function(t,e,r){e?/^[\d\w\u4e00-\u9fa5,.;:"'?!-]{2,12}$/.test(e)||r(new Error("昵称的格式不正确")):r(new Error("请填写昵称")),r()},a=function(t,e,r){e?/^[\u4e00-\u9fa5]{1,6}(·[\u4e00-\u9fa5]{1,6}){0,2}$/.test(e)||r(new Error("姓名的格式不正确")):r(new Error("请填写姓名")),r()},i=function(t,e,r){e?/^[\w.-]+@(?:[a-z0-9]+(?:-[a-z0-9]+)*\.)+[a-z]{2,3}$/.test(e)||r(new Error("邮箱的格式不正确")):r(),r()},o={name:"EditForm",props:{formData:Object},data:function(){return{form:{},rules:{nickname:[{validator:n,trigger:"blur"}],real_name:[{validator:a,trigger:"blur"}],email:[{validator:i,trigger:"blur"}]}}},watch:{formData:{handler:function(t){this.form=t||{account:"",nickname:"",real_name:"",email:""}},immediate:!0}},methods:{submit:function(){var t;return this.$refs.form.validate(function(e){return e?(t=!0,!0):(t=!1,!1)}),t}}},s=(r("83ca"),r("2877")),c=Object(s.a)(o,function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",[r("el-form",{ref:"form",staticClass:"edit",attrs:{"hide-required-asterisk":"",rules:t.rules,model:t.form}},[r("el-form-item",{attrs:{label:"登入账号",prop:"account",required:""}},[r("el-input",{attrs:{placeholder:"请填写登入账号"},model:{value:t.form.account,callback:function(e){t.$set(t.form,"account",e)},expression:"form.account"}})],1),r("el-form-item",{attrs:{label:"昵称",prop:"nickname"}},[r("el-input",{attrs:{placeholder:"只能是中文、字母、数字"},model:{value:t.form.nickname,callback:function(e){t.$set(t.form,"nickname",e)},expression:"form.nickname"}})],1),r("el-form-item",{attrs:{label:"真实姓名",prop:"real_name"}},[r("el-input",{model:{value:t.form.real_name,callback:function(e){t.$set(t.form,"real_name",e)},expression:"form.real_name"}})],1),r("el-form-item",{attrs:{label:"邮箱（选填）",prop:"email"}},[r("el-input",{model:{value:t.form.email,callback:function(e){t.$set(t.form,"email",e)},expression:"form.email"}})],1)],1)],1)},[],!1,null,"17dcd5f5",null);e.a=c.exports},4411:function(t,e,r){"use strict";r("6762"),r("2fdb");var n=r("5d58"),a=r.n(n),i=r("67bb"),o=r.n(i);function s(t){return(s="function"==typeof o.a&&"symbol"==typeof a.a?function(t){return typeof t}:function(t){return t&&"function"==typeof o.a&&t.constructor===o.a&&t!==o.a.prototype?"symbol":typeof t})(t)}function c(t){return(c="function"==typeof o.a&&"symbol"===s(a.a)?function(t){return s(t)}:function(t){return t&&"function"==typeof o.a&&t.constructor===o.a&&t!==o.a.prototype?"symbol":s(t)})(t)}r("ac4d"),r("8a81"),r("ac6a"),r("456d");var u={name:"EditPermission",props:{editable:{type:Boolean,default:!1},allSelected:Boolean,permissions:Array},data:function(){return{per:[],modules:{user:"用户",goods:"商品",order:"订单",comment:"留言",guide:"指引",admin:"管理员"},actions:["read","write","create","delete"]}},watch:{permissions:{handler:function(t){t?this.setPermissions():this.initValues()},immediate:!0},allSelected:function(t){this.setAllCheckboxStatus(t)}},methods:{initValues:function(){var t=this,e=[{read:!1},{write:!1},{create:!1},{delete:!1}];this.per=Object.keys(this.modules).map(function(r){return{module:r,purview:t.$cloneDeepWith(e)}})},setPermissions:function(){var t=this,e=this.$cloneDeepWith(this.permissions);this.per=Object.keys(this.modules).map(function(r){var n=!0,a=!1,i=void 0;try{for(var o,s=function(){var e=o.value;if(e.module===r)return{v:{module:r,purview:t.actions.map(function(t){var r={};return r["".concat(t)]=e.purview.includes(t),r})}}},u=e[Symbol.iterator]();!(n=(o=u.next()).done);n=!0){var l=s();if("object"===c(l))return l.v}}catch(t){a=!0,i=t}finally{try{n||null==u.return||u.return()}finally{if(a)throw i}}return{module:r,purview:[{read:!1},{write:!1},{create:!1},{delete:!1}]}})},setAllCheckboxStatus:function(t){var e=this;this.per.forEach(function(r){r.purview.forEach(function(r,n){r[e.actions[n]]=t})})},getPermissions:function(){var t=this;return this.per.map(function(e){return{module:e.module,purview:e.purview.filter(function(e,r){return e[t.actions[r]]}).map(function(t){return Object.keys(t)[0]})}})}}},l=(r("9e95"),r("2877")),f=Object(l.a)(u,function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",[t.per?r("table",{staticClass:"permission"},[t._m(0),t._l(t.per,function(e,n){return r("tr",{key:n},[r("td",[t._v(t._s(t.modules[e.module]))]),t._l(e.purview,function(e,n){return r("td",{key:n},[r("vs-checkbox",{class:{"pointer-events-none":!t.editable},attrs:{disabled:!t.editable},model:{value:e[t.actions[n]],callback:function(r){t.$set(e,t.actions[n],r)},expression:"td[actions[j]]"}})],1)})],2)})],2):t._e()])},[function(){var t=this.$createElement,e=this._self._c||t;return e("tr",[e("th",[this._v("Module")]),e("th",[this._v("Read")]),e("th",[this._v("Write")]),e("th",[this._v("Create")]),e("th",[this._v("Delete")])])}],!1,null,"19adfc7a",null);e.a=f.exports},"456d":function(t,e,r){var n=r("4bf8"),a=r("0d58");r("5eda")("keys",function(){return function(t){return a(n(t))}})},"577c":function(t,e,r){"use strict";r.r(e);r("96cf");var n=r("3b8d"),a=r("b0e1"),i=r("3bda"),o=r("bb2a"),s=r("4411"),c=r("518e"),u={name:"AdminEdit",components:{EditAvatar:a.a,EditForm:i.a,EditPassword:o.a,EditPermission:s.a},data:function(){return{info:{},detail:{}}},created:function(){this.getAdminDetail()},methods:{getAdminDetail:function(){var t=Object(n.a)(regeneratorRuntime.mark(function t(){var e,r,n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(c.d)({admin_id:this.$route.query.adminId});case 2:e=t.sent,r=e.code,n=e.data.admin_detail,2e3===r&&(this.detail=n,this.info={_id:n._id,nickname:n.nickname,real_name:n.real_name,email:n.email});case 6:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}(),onUpdateAmin:function(){var t=this;this.$refs.editForm.submit()&&this.$loading(Object(n.a)(regeneratorRuntime.mark(function e(){var r,n,a,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=Object.assign({admin_id:t.info._id,gender:t.$refs.editAvatar.selectedGender,permissions:t.$refs.editPermissions.getPermissions()},t.$refs.editForm.form),e.next=3,Object(c.l)(r);case 3:if(n=e.sent,a=n.code,i=n.msg,2e3!==a){e.next=12;break}return e.next=9,t.getAdminDetail();case 9:t.$vs.notify({title:"信息更新成功",text:i,color:"success"}),e.next=13;break;case 12:throw new Error(i);case 13:case"end":return e.stop()}},e)})),{container:"#main",scale:1},null,function(e){t.$vs.notify({title:"信息更新失败",text:e,color:"danger"})})}}},l=(r("6cbd"),r("2877")),f=Object(l.a)(u,function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",[r("vs-tabs",{staticClass:"p-6 bg-main vs-con-loading__container",attrs:{id:"main"}},[r("vs-tab",{staticClass:"px-4 py-10",attrs:{icon:"el-icon-user","icon-pack":"el-icon",label:"账号信息"}},[r("div",{staticClass:"mb-8 flex"},[r("div",{staticClass:"mr-16"},[r("EditAvatar",{ref:"editAvatar",attrs:{"admin-id":t.detail._id,avatar:t.detail.avatar_url,gender:t.detail.gender},on:{updateInfo:function(e){return t.getAdminDetail()}}})],1),r("div",{staticClass:"w-1/2"},[r("EditForm",{ref:"editForm",attrs:{"form-data":t.info}})],1)]),r("div",{staticClass:"mb-5 p-5 rounded-lg border-primary",staticStyle:{"border-width":"1px","border-style":"solid"}},[r("p",{staticClass:"text-lg text-semi"},[t._v("权 限")]),r("vs-divider"),r("EditPermission",{ref:"editPermissions",attrs:{permissions:t.detail.permissions,editable:!0}})],1),r("div",{staticClass:"flex"},[r("vs-button",{staticClass:"save ml-auto",on:{click:function(e){return t.onUpdateAmin()}}},[t._v("保存设置")])],1)]),r("vs-tab",{staticClass:"px-4 py-10",attrs:{icon:"el-icon-key","icon-pack":"el-icon",label:"安全设置"}},[r("div",{staticClass:"w-1/2"},[r("EditPassword"),r("vs-button",{attrs:{id:"btn"}},[t._v("确认修改密码")])],1)])],1)],1)},[],!1,null,"0970e7c6",null);e.default=f.exports},"5d58":function(t,e,r){t.exports=r("d8d6")},"5eda":function(t,e,r){var n=r("5ca1"),a=r("8378"),i=r("79e5");t.exports=function(t,e){var r=(a.Object||{})[t]||Object[t],o={};o[t]=e(r),n(n.S+n.F*i(function(){r(1)}),"Object",o)}},"67ab":function(t,e,r){var n=r("ca5a")("meta"),a=r("d3f4"),i=r("69a8"),o=r("86cc").f,s=0,c=Object.isExtensible||function(){return!0},u=!r("79e5")(function(){return c(Object.preventExtensions({}))}),l=function(t){o(t,n,{value:{i:"O"+ ++s,w:{}}})},f=t.exports={KEY:n,NEED:!1,fastKey:function(t,e){if(!a(t))return"symbol"==typeof t?t:("string"==typeof t?"S":"P")+t;if(!i(t,n)){if(!c(t))return"F";if(!e)return"E";l(t)}return t[n].i},getWeak:function(t,e){if(!i(t,n)){if(!c(t))return!0;if(!e)return!1;l(t)}return t[n].w},onFreeze:function(t){return u&&f.NEED&&c(t)&&!i(t,n)&&l(t),t}}},"67bb":function(t,e,r){t.exports=r("f921")},"6cbd":function(t,e,r){"use strict";var n=r("39f7");r.n(n).a},"7bbc":function(t,e,r){var n=r("6821"),a=r("9093").f,i={}.toString,o="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];t.exports.f=function(t){return o&&"[object Window]"==i.call(t)?function(t){try{return a(t)}catch(t){return o.slice()}}(t):a(n(t))}},"83ca":function(t,e,r){"use strict";var n=r("fd60");r.n(n).a},"8a81":function(t,e,r){"use strict";var n=r("7726"),a=r("69a8"),i=r("9e1e"),o=r("5ca1"),s=r("2aba"),c=r("67ab").KEY,u=r("79e5"),l=r("5537"),f=r("7f20"),d=r("ca5a"),m=r("2b4c"),p=r("37c8"),v=r("3a72"),b=r("d4c0"),h=r("1169"),y=r("cb7c"),w=r("d3f4"),g=r("4bf8"),_=r("6821"),x=r("6a99"),k=r("4630"),E=r("2aeb"),O=r("7bbc"),S=r("11e9"),P=r("2621"),j=r("86cc"),A=r("0d58"),$=S.f,C=j.f,F=O.f,D=n.Symbol,N=n.JSON,G=N&&N.stringify,I=m("_hidden"),R=m("toPrimitive"),U={}.propertyIsEnumerable,J=l("symbol-registry"),W=l("symbols"),z=l("op-symbols"),q=Object.prototype,K="function"==typeof D&&!!P.f,M=n.QObject,T=!M||!M.prototype||!M.prototype.findChild,B=i&&u(function(){return 7!=E(C({},"a",{get:function(){return C(this,"a",{value:7}).a}})).a})?function(t,e,r){var n=$(q,e);n&&delete q[e],C(t,e,r),n&&t!==q&&C(q,e,n)}:C,V=function(t){var e=W[t]=E(D.prototype);return e._k=t,e},Y=K&&"symbol"==typeof D.iterator?function(t){return"symbol"==typeof t}:function(t){return t instanceof D},Q=function(t,e,r){return t===q&&Q(z,e,r),y(t),e=x(e,!0),y(r),a(W,e)?(r.enumerable?(a(t,I)&&t[I][e]&&(t[I][e]=!1),r=E(r,{enumerable:k(0,!1)})):(a(t,I)||C(t,I,k(1,{})),t[I][e]=!0),B(t,e,r)):C(t,e,r)},H=function(t,e){y(t);for(var r,n=b(e=_(e)),a=0,i=n.length;i>a;)Q(t,r=n[a++],e[r]);return t},L=function(t){var e=U.call(this,t=x(t,!0));return!(this===q&&a(W,t)&&!a(z,t))&&(!(e||!a(this,t)||!a(W,t)||a(this,I)&&this[I][t])||e)},X=function(t,e){if(t=_(t),e=x(e,!0),t!==q||!a(W,e)||a(z,e)){var r=$(t,e);return!r||!a(W,e)||a(t,I)&&t[I][e]||(r.enumerable=!0),r}},Z=function(t){for(var e,r=F(_(t)),n=[],i=0;r.length>i;)a(W,e=r[i++])||e==I||e==c||n.push(e);return n},tt=function(t){for(var e,r=t===q,n=F(r?z:_(t)),i=[],o=0;n.length>o;)!a(W,e=n[o++])||r&&!a(q,e)||i.push(W[e]);return i};K||(s((D=function(){if(this instanceof D)throw TypeError("Symbol is not a constructor!");var t=d(arguments.length>0?arguments[0]:void 0),e=function(r){this===q&&e.call(z,r),a(this,I)&&a(this[I],t)&&(this[I][t]=!1),B(this,t,k(1,r))};return i&&T&&B(q,t,{configurable:!0,set:e}),V(t)}).prototype,"toString",function(){return this._k}),S.f=X,j.f=Q,r("9093").f=O.f=Z,r("52a7").f=L,P.f=tt,i&&!r("2d00")&&s(q,"propertyIsEnumerable",L,!0),p.f=function(t){return V(m(t))}),o(o.G+o.W+o.F*!K,{Symbol:D});for(var et="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),rt=0;et.length>rt;)m(et[rt++]);for(var nt=A(m.store),at=0;nt.length>at;)v(nt[at++]);o(o.S+o.F*!K,"Symbol",{for:function(t){return a(J,t+="")?J[t]:J[t]=D(t)},keyFor:function(t){if(!Y(t))throw TypeError(t+" is not a symbol!");for(var e in J)if(J[e]===t)return e},useSetter:function(){T=!0},useSimple:function(){T=!1}}),o(o.S+o.F*!K,"Object",{create:function(t,e){return void 0===e?E(t):H(E(t),e)},defineProperty:Q,defineProperties:H,getOwnPropertyDescriptor:X,getOwnPropertyNames:Z,getOwnPropertySymbols:tt});var it=u(function(){P.f(1)});o(o.S+o.F*it,"Object",{getOwnPropertySymbols:function(t){return P.f(g(t))}}),N&&o(o.S+o.F*(!K||u(function(){var t=D();return"[null]"!=G([t])||"{}"!=G({a:t})||"{}"!=G(Object(t))})),"JSON",{stringify:function(t){for(var e,r,n=[t],a=1;arguments.length>a;)n.push(arguments[a++]);if(r=e=n[1],(w(e)||void 0!==t)&&!Y(t))return h(e)||(e=function(t,e){if("function"==typeof r&&(e=r.call(this,t,e)),!Y(e))return e}),n[1]=e,G.apply(N,n)}}),D.prototype[R]||r("32e9")(D.prototype,R,D.prototype.valueOf),f(D,"Symbol"),f(Math,"Math",!0),f(n.JSON,"JSON",!0)},"9e95":function(t,e,r){"use strict";var n=r("2d82");r.n(n).a},ac4d:function(t,e,r){r("3a72")("asyncIterator")},b0e1:function(t,e,r){"use strict";r("c5f6");var n=r("8bbf"),a=r.n(n).a.component("ReplaceAvatar",function(){return Promise.all([r.e("chunk-908ae0c2"),r.e("chunk-b84babcc")]).then(r.bind(null,"0a78"))}),i={male:"https://cdn.hrspider.top/default_avatar_male.jpg",female:"https://cdn.hrspider.top/default_avatar_female.jpg"},o={name:"EditAvatar",components:{ReplaceAvatar:a},props:{adminId:String,avatar:String,gender:Number},data:function(){return{defaultAvatar:i,selectedGender:0,avatarUrl:"https://cdn.hrspider.top/default_avatar_male.jpg",showAvatarPopup:!1}},watch:{selectedGender:{handler:function(t){var e=this.defaultAvatar,r=e.male,n=e.female;this.avatarUrl!==r&&this.avatarUrl!==n||(this.avatarUrl=t?n:r)},immediate:!0},avatar:{handler:function(t){(null==t?void 0:t.length)>0&&(this.avatarUrl=t)},immediate:!0},gender:{handler:function(t){t&&(this.selectedGender=t)},immediate:!0}}},s=r("2877"),c=Object(s.a)(o,function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",[r("img",{staticClass:"heavy-shadow radius",attrs:{width:"150px",src:t.avatarUrl}}),r("div",{staticClass:"my-3  flex"},[r("div",{staticClass:"mr-3 px-3 py-1 primary rounded-lg cursor-pointer",staticStyle:{background:"rgba(var(--vs-primary), 0.1)"},on:{click:function(e){t.selectedGender=0}}},[t._v("\n      汉子\n      "),r("i",{directives:[{name:"show",rawName:"v-show",value:!t.selectedGender,expression:"!selectedGender"}],staticClass:"el-icon-check"})]),r("div",{staticClass:"px-3 py-1 danger rounded-lg cursor-pointer",staticStyle:{background:"rgba(var(--vs-danger), 0.1)"},on:{click:function(e){t.selectedGender=1}}},[t._v("\n      妹纸\n      "),r("i",{directives:[{name:"show",rawName:"v-show",value:t.selectedGender,expression:"selectedGender"}],staticClass:"el-icon-check"})])]),t.adminId?r("vs-button",{staticClass:"w-full max-w-xs",attrs:{size:"small",type:"border"},on:{click:function(e){t.showAvatarPopup=!0}}},[t._v("更换头像")]):t._e(),r("ReplaceAvatar",{ref:"replaceAvatar",attrs:{"admin-id":t.adminId,popupActive:t.showAvatarPopup},on:{updateInfo:function(e){return t.$emit("updateInfo")},closePopup:function(e){t.showAvatarPopup=!1}}})],1)},[],!1,null,null,null);e.a=c.exports},bb2a:function(t,e,r){"use strict";var n=function(t,e,r){e||r(new Error("请填写原始密码")),r()},a=function(t,e,r){e?/^[\w]{6,16}$/.test(e)||r(new Error("密码不符合规范")):r(new Error("请填写密码")),r()},i={name:"EditPassword",data:function(){var t=this;return{form:{oldPassword:"",password:"",password2:""},rules:{oldPassword:[{validator:n,trigger:"blur"}],password:[{validator:a,trigger:"blur"}],password2:[{validator:function(e,r,n){r?r!==t.form.password&&n(new Error("与前一次密码不一致")):n(new Error("请确认二次密码")),n()},trigger:"blur"}]}}},methods:{submit:function(){var t;return this.$refs.form.validate(function(e){return e?(t=!0,!0):(t=!1,!1)}),t}}},o=(r("ea7f"),r("2877")),s=Object(o.a)(i,function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",[r("el-form",{ref:"form",staticClass:"edit",attrs:{"label-position":"top",rules:t.rules,model:t.form}},[r("el-form-item",{attrs:{label:"原始密码",prop:"oldPassword"}},[r("el-input",{attrs:{type:"password",placeholder:"请填写账号原始密码"},model:{value:t.form.oldPassword,callback:function(e){t.$set(t.form,"oldPassword",e)},expression:"form.oldPassword"}})],1),r("el-form-item",{attrs:{label:"密码",prop:"password"}},[r("el-input",{attrs:{type:"password",placeholder:"6-16个字符，只能是字母、数字和下划线"},model:{value:t.form.password,callback:function(e){t.$set(t.form,"password",e)},expression:"form.password"}})],1),r("el-form-item",{attrs:{label:"确认密码",prop:"password2"}},[r("el-input",{attrs:{type:"password",placeholder:"请再次输入密码"},model:{value:t.form.password2,callback:function(e){t.$set(t.form,"password2",e)},expression:"form.password2"}})],1)],1)],1)},[],!1,null,"9c93887c",null);e.a=s.exports},d4c0:function(t,e,r){var n=r("0d58"),a=r("2621"),i=r("52a7");t.exports=function(t){var e=n(t),r=a.f;if(r)for(var o,s=r(t),c=i.f,u=0;s.length>u;)c.call(t,o=s[u++])&&e.push(o);return e}},ea7f:function(t,e,r){"use strict";var n=r("2e72");r.n(n).a},fd60:function(t,e,r){}}]);